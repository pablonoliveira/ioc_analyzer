# üõ°Ô∏è IOC Analyzer

**Plataforma Blue Team para An√°lise de Indicadores de Comprometimento e CVEs**

![Version](https://img.shields.io/badge/version-2.1-blue.svg)
![Status](https://img.shields.io/badge/status-stable-green.svg)
![Python](https://img.shields.io/badge/python-3.8+-blue.svg)
![License](https://img.shields.io/badge/license-MIT-yellow.svg)

---

## üìë √çndice

- [Sobre o Projeto](#-sobre-o-projeto)
- [Funcionalidades](#-funcionalidades)
- [Estrutura do Projeto](#-estrutura-do-projeto)
- [Instala√ß√£o](#-instala√ß√£o)
- [Configura√ß√£o](#Ô∏è-configura√ß√£o)
- [Como Usar](#-como-usar)
- [APIs Integradas](#-apis-integradas)
- [Screenshots](#-screenshots)
- [Roadmap](#Ô∏è-roadmap)
- [Como Contribuir](#-como-contribuir)
- [Licen√ßa](#-licen√ßa)

---

## üìñ Sobre o Projeto

O **IOC Analyzer** √© uma plataforma desenvolvida para equipes de Blue Team e profissionais de Ciberseguran√ßa em geral que precisam gerenciar, analisar e correlacionar Indicadores de Comprometimento (IoCs) e Vulnerabilidades (CVEs) de forma eficiente.

> ‚úÖ **Vers√£o 2.1 - Est√°vel e Pronta para Produ√ß√£o**  
> Esta vers√£o inclui todas as funcionalidades essenciais consolidadas, interface visual aprimorada e integra√ß√µes de API testadas.

### üéØ Principais Objetivos

- **Centraliza√ß√£o**: Gerenciar IoCs e CVEs em um √∫nico local
- **Automa√ß√£o**: Buscar e enriquecer dados de m√∫ltiplas fontes
- **Visualiza√ß√£o**: Dashboard interativo com gr√°ficos e estat√≠sticas
- **Correla√ß√£o**: Relacionar IoCs com CVEs conhecidas
- **An√°lise Forense**: Suporte a investiga√ß√µes e per√≠cia digital

---

## ‚ú® Funcionalidades

### üìä Dashboard Interativo
- 6 gr√°ficos din√¢micos
- Estat√≠sticas em tempo real ap√≥s consulta
- Porcentagens autom√°ticas
- Vis√£o geral do ambiente

### üîç IOC Panel
- Painel completo de IoCs
- Busca visual na p√°gina
- Suporte: IPs, URLs, Hashes, Dom√≠nios
- Classifica√ß√£o por tipo e severidade

### üõ°Ô∏è CVE Panel
- Gerenciamento de CVEs
- Integra√ß√£o NVD API
- Severidade (CVSS v3.1)
- Tradu√ß√£o autom√°tica para portugu√™s

### üîó Integra√ß√µes API
- **VirusTotal**: An√°lise de URLs, dom√≠nios, IPs e hashes
- **AbuseIPDB**: Reputa√ß√£o de endere√ßos IP
- **CISA KEV**: CVEs ativamente exploradas
- **CIRCL CVE**: Base alternativa de CVEs
- **NVD (NIST)**: Base nacional de vulnerabilidades

### üé® Interface Moderna
- Tema escuro profissional
- Responsivo (mobile-first)
- Cards visuais organizados
- Navega√ß√£o intuitiva

### üíæ Persist√™ncia de Dados
- JSON Database
- Export/Import
- Backup autom√°tico
- Hist√≥rico completo

---

## üìÅ Estrutura do Projeto

```
ioc_analyzer/
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ ioc_database.json      # Base de IoCs
‚îÇ   ‚îî‚îÄ‚îÄ cve_database.json      # Base de CVEs
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îú‚îÄ‚îÄ img/                   # Screenshots
‚îÇ   ‚îî‚îÄ‚îÄ DOCUMENTACAO.html      # Documenta√ß√£o interativa
‚îú‚îÄ‚îÄ ioc/
‚îÇ   ‚îú‚îÄ‚îÄ abuseipdb_client.py    # Cliente AbuseIPDB
‚îÇ   ‚îú‚îÄ‚îÄ virustotal_client.py   # Cliente VirusTotal
‚îÇ   ‚îú‚îÄ‚îÄ cisa_kev_client.py     # Cliente CISA KEV
‚îÇ   ‚îú‚îÄ‚îÄ circl_cve_client.py    # Cliente CIRCL CVE
‚îÇ   ‚îú‚îÄ‚îÄ nvd_cve_client.py      # Cliente NVD ‚úÖ
‚îÇ   ‚îî‚îÄ‚îÄ url_checker.py         # Verificador de URLs
‚îú‚îÄ‚îÄ parsers/
‚îÇ   ‚îî‚îÄ‚îÄ log_parser.py          # Parser de logs
‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îú‚îÄ‚îÄ dashboard.html         # Dashboard principal
‚îÇ   ‚îú‚îÄ‚îÄ ioc_panel.html         # Painel de IoCs
‚îÇ   ‚îî‚îÄ‚îÄ cve_panel.html         # Painel de CVEs
‚îú‚îÄ‚îÄ webapp.py                  # Aplica√ß√£o Flask
‚îú‚îÄ‚îÄ requirements.txt           # Depend√™ncias Python
‚îú‚îÄ‚îÄ .env                       # Vari√°veis de ambiente
‚îú‚îÄ‚îÄ .gitignore
‚îî‚îÄ‚îÄ README.md
```

---

## üöÄ Instala√ß√£o

### Pr√©-requisitos

- Python 3.8 ou superior
- pip (gerenciador de pacotes Python)
- Git

### Passo 1: Clonar o Reposit√≥rio

```bash
git clone https://github.com/SEU_USUARIO/ioc_analyzer.git
cd ioc_analyzer
```

### Passo 2: Criar Ambiente Virtual (Recomendado)

```bash
# Linux/Mac
python3 -m venv venv
source venv/bin/activate

# Windows
python -m venv venv
venv\Scripts\activate
```

### Passo 3: Instalar Depend√™ncias

```bash
pip install -r requirements.txt
```

> üì¶ **Depend√™ncias principais**: Flask, Requests, python-dotenv, googletrans

---

## ‚öôÔ∏è Configura√ß√£o

### Passo 1: Criar arquivo .env

Crie um arquivo `.env` na raiz do projeto com suas chaves de API:

```env
# APIs de Threat Intelligence
VIRUSTOTAL_API_KEY=sua_chave_aqui
ABUSEIPDB_API_KEY=sua_chave_aqui
NVD_API_KEY=sua_chave_aqui

# Configura√ß√µes da aplica√ß√£o
FLASK_ENV=development
FLASK_DEBUG=True
SECRET_KEY=sua_chave_secreta_aqui
```

### Passo 2: Obter API Keys

| Servi√ßo | URL de Registro | Plano Gratuito | Limite |
|---------|----------------|----------------|---------|
| **VirusTotal** | [virustotal.com](https://www.virustotal.com/gui/join-us) | ‚úÖ Sim | 500 req/dia |
| **AbuseIPDB** | [abuseipdb.com](https://www.abuseipdb.com/register) | ‚úÖ Sim | 1.000 req/dia |
| **NVD** | [nvd.nist.gov](https://nvd.nist.gov/developers/request-an-api-key) | ‚úÖ Sim | 50 req/30s |
| **CISA KEV** | - | ‚úÖ P√∫blica | Sem limite |
| **CIRCL CVE** | - | ‚úÖ P√∫blica | Sem limite |

> ‚ö†Ô∏è **Importante**: Sem as API keys, algumas funcionalidades estar√£o limitadas. O IOC Analyzer funcionar√° com funcionalidades b√°sicas usando apenas APIs p√∫blicas (CISA KEV e CIRCL CVE).

### Passo 3: Inicializar Bases de Dados

Os arquivos JSON ser√£o criados automaticamente na primeira execu√ß√£o em `data/`:

```
data/ioc_database.json    # Iniciado como []
data/cve_database.json    # Iniciado como []
```

---

## üíª Como Usar

### Iniciar a Aplica√ß√£o

```bash
python webapp.py
```

A aplica√ß√£o estar√° dispon√≠vel em: **http://localhost:5000**

### Navega√ß√£o

- **Dashboard**: `/` - Vis√£o geral com gr√°ficos e estat√≠sticas
- **IOC Panel**: `/ioc` - Gerenciamento de Indicadores de Comprometimento
- **CVE Panel**: `/cve` - Gerenciamento de Vulnerabilidades

### Gerenciar IoCs

1. Acesse o **IOC Panel**
2. Clique em **"Adicionar Novo IOC"**
3. Preencha os campos:
   - **Tipo**: IP, Domain, URL, Hash
   - **Valor**: O indicador (ex: `192.168.1.1`)
   - **Fonte**: Onde foi identificado
   - **Severidade**: Critical, High, Medium, Low
   - **Descri√ß√£o**: Contexto adicional
4. Clique em **"Salvar"**

### Buscar CVEs

1. Acesse o **CVE Panel**
2. Digite o ID da CVE (ex: `CVE-2024-21413`)
3. Clique em **"Buscar CVE"**
4. Os resultados ser√£o exibidos com:
   - Severidade (CVSS Score)
   - Descri√ß√£o traduzida
   - Data de publica√ß√£o
   - Links para refer√™ncias
5. Clique em **"Salvar no Banco"** para persistir

### Busca Visual

Tanto o IOC Panel quanto o CVE Panel possuem campo de busca no topo que filtra os resultados em tempo real.

---

## üîå APIs Integradas

### ‚úÖ VirusTotal
**Fun√ß√£o**: An√°lise de URLs, dom√≠nios, IPs e hashes de arquivos  
**Dados retornados**: Detec√ß√µes de antiv√≠rus, reputa√ß√£o, categorias

### ‚úÖ AbuseIPDB
**Fun√ß√£o**: Reputa√ß√£o de endere√ßos IP  
**Dados retornados**: Score de abuso, categoria de ataques, relat√≥rios

### ‚úÖ NVD (NIST)
**Fun√ß√£o**: Base nacional de vulnerabilidades (EUA)  
**Dados retornados**: CVEs completas com CVSS v3.1, descri√ß√µes, refer√™ncias

### ‚úÖ CISA KEV
**Fun√ß√£o**: CVEs ativamente exploradas  
**Dados retornados**: Cat√°logo de exploits conhecidos, datas de explora√ß√£o

### ‚úÖ CIRCL CVE
**Fun√ß√£o**: Base de CVEs alternativa (Luxemburgo)  
**Dados retornados**: CVEs com descri√ß√µes e refer√™ncias

### ‚öôÔ∏è Tradu√ß√£o Autom√°tica
**Fun√ß√£o**: Traduzir descri√ß√µes de CVEs para portugu√™s  
**Biblioteca**: googletrans (fallback para descri√ß√£o original)

---

## üì∏ Screenshots

> üí° **Dica**: Veja a documenta√ß√£o completa interativa em `docs/documentacao.html`

### Dashboard Principal
![Dashboard](docs/img/dashboard.png)

### IOC Panel
![IOC Panel](docs/img/ioc_panel.png)

### CVE Panel
![CVE Panel](docs/img/cve_panel.png)

---

## üó∫Ô∏è Roadmap

### ‚úÖ v2.1 (Atual - Est√°vel)
- Dashboard interativo com 6 gr√°ficos
- PAINEL completo de IoCs e CVEs
- Integra√ß√£o com 5 APIs
- Tradu√ß√£o autom√°tica
- Interface visual moderna

### üöß v3.0 (Pr√≥xima - Em Planejamento)
- **Bot√£o "Buscar CVEs 24h"**: Automa√ß√£o de busca de CVEs recentes
- **Correla√ß√£o IOC ‚Üî CVE**: Relacionamento autom√°tico
- **Exporta√ß√£o de Relat√≥rios**: PDF, CSV, JSON
- **Sistema de Alertas**: Email, Telegram, Webhook
- **Scoring Automatizado**: Classifica√ß√£o de risco
- **Ingest√£o de Feeds**: AlienVault OTX, URLhaus, ThreatFox

### üîÆ v4.0 (Futuro)
- **API REST Completa**: Endpoints para integra√ß√£o externa
- **Autentica√ß√£o**: Multi-usu√°rio com controle de acesso
- **Banco de Dados Relacional**: Migra√ß√£o para PostgreSQL
- **Integra√ß√£o SIEM**: Splunk, ELK, Wazuh, TheHive
- **Agentes de IA**: Classifica√ß√£o e correla√ß√£o inteligente
- **Docker**: Containeriza√ß√£o completa

---

## ü§ù Como Contribuir

Contribui√ß√µes s√£o bem-vindas! Siga os passos abaixo:

1. **Fork** o projeto
2. Crie uma **branch** para sua feature (`git checkout -b feature/NovaFuncionalidade`)
3. **Commit** suas mudan√ßas (`git commit -m 'Adiciona nova funcionalidade'`)
4. **Push** para a branch (`git push origin feature/NovaFuncionalidade`)
5. Abra um **Pull Request**

### Diretrizes

- Mantenha o c√≥digo limpo e documentado
- Siga o padr√£o PEP 8 para Python
- Adicione testes quando aplic√°vel
- Atualize a documenta√ß√£o conforme necess√°rio

### Reportar Bugs

Encontrou um bug? Abra uma **Issue** no GitHub com:

- Descri√ß√£o clara do problema
- Passos para reproduzir
- Comportamento esperado vs. atual
- Logs de erro (se aplic√°vel)
- Ambiente (SO, vers√£o Python, etc.)

---

## üìÑ Licen√ßa

**GNU GENERAL PUBLIC LICENSEMIT License**

Este projeto est√° licenciado sob a Licen√ßa GNU GENERAL PUBLIC LICENSE - veja o arquivo LICENSE para detalhes.

Copyright ¬© 2025 - IOC Analyzer Project

---

## üë®‚Äçüíª Autor

**Pablo Oliveira**

- üåê LinkedIn: [Pablo Oliveira](https://linkedin.com/in/pabloliveira)
- üìß Email: pabloliveir@gmail.com
- üíº Especializa√ß√£o: Especialista em Defesa Cibern√©tica | Seguran√ßa de Redes e Administra√ß√£o de Sistemas | Per√≠cia Forense Computacional | Engenharia de Sistemas
- üìö Experi√™ncia: ~20 anos em TI e Seguran√ßa da Informa√ß√£o

---

## üôè Agradecimentos

- **VirusTotal**, **AbuseIPDB**, **NVD**, **CISA**, **CIRCL** - Pelas APIs p√∫blicas
- Comunidade de **Threat Intelligence**
- Profissionais de **Blue Team** e **Cybersecurity**

---

<div align="center">

**Desenvolvido para Analistas de Seguran√ßa da Informa√ß√£o que atuam diretamente em SOC e Blue Team**

**IOC Analyzer v2.1** - Outubro 2025

</div>