<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IOC Analyzer - Blue Team Platform</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #222;
            min-height: 100vh;
            margin: 0;
        }
        .container { max-width: 1400px; margin: 0 auto; padding: 28px 12px 70px 12px; }
        .header-card {
            background: #F5F7FB;
            border-radius: 20px;
            padding: 28px;
            margin-bottom: 32px;
            box-shadow: 0 8px 32px #0002;
        }
        nav {
            display: flex;
            gap: 18px;
            margin-bottom: 24px;
        }
        .nav-btn {
            padding: 12px 26px;
            background: linear-gradient(90deg, #667eea 0, #764ba2 100%);
            color: white;
            border-radius: 11px;
            font-weight: 600;
            font-size: 1.07em;
            text-decoration: none;
            box-shadow: 0 2px 10px #667eea22;
            border: none;
            display: flex;
            align-items: center;
            gap: 7px;
            transition: box-shadow 0.2s, background 0.2s;
        }
        .nav-btn.active, .nav-btn:hover {
            background: linear-gradient(90deg, #764ba2 0%, #667eea 100%);
            box-shadow: 0 8px 28px #764ba255;
        }
        .header-title {
            display: flex;
            align-items: center;
            gap: 13px;
            font-size: 2.6em;
            color: #667eea;
            font-weight: 700;
            margin: 0;
            margin-bottom: 2px;
        }
        .subtitle { color: #444; margin-top: 7px; }
        .main-card {
            background: #f7f8fc;
            border-radius: 14px;
            box-shadow: 0 2px 16px #0001;
            padding: 26px 18px 30px 18px;
            margin-bottom: 32px;
        }
        .main-card h2 {
            color: #667eea;
            font-size: 1.5em;
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 0 0 15px 0;
            font-weight: 700;
        }
        form { margin-bottom: 0; }
        .form-input {
            flex: 1;
            padding: 13px 14px;
            font-size: 1.09em;
            border: 2px solid #dde;
            border-radius: 10px;
            background: #fff;
            margin-right: 0.7em;
        }
        .form-input:focus { outline: 3px solid #667eea20; }
        .btn-primary {
            padding: 12px 29px;
            background: linear-gradient(90deg,#667eea 0,#764ba2 100%);
            color: white;
            font-weight: 600;
            border: none;
            border-radius: 10px;
            box-shadow: 0 2px 16px #667eea33;
            font-size: 1.14em;
            cursor: pointer;
            transition: background 0.20s;
        }
        .btn-primary:hover { background: #667eea; }
        .api-result {
            margin-top: 18px;
            background: #eaf5ea;
            color: #274d27;
            border-left: 6px solid #28a745;
            border-radius: 9px;
            padding: 18px;
            font-size: 1.09em;
        }
        .api-result.error {
            background: #fbeaec;
            color: #dc3545;
            border-left: 6px solid #dc3545;
        }
        .table-card {
            background: #fcfdff;
            border-radius: 14px;
            box-shadow: 0 2px 16px #0001;
            padding: 26px 18px 30px 18px;
            margin-bottom: 12px;
        }
        .table-card h2 {
            color: #667eea;
            font-size: 1.3em;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
            margin-bottom: 18px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            background: #f7f8fc;
            border-radius:10px;
            overflow: hidden;
        }
        th, td {
            padding: 13px 9px;
            border-bottom: 1px solid #ececec;
            text-align: left;
            font-size: 1.07em;
        }
        th {
            background: linear-gradient(90deg, #667eea 0, #764ba2 100%);
            color: #fff;
            font-weight: 600;
            border: none;
        }
        tr:last-child td { border-bottom: none; }
        tr:hover td { background: #f4f6ff; }
        .btn-excluir {
            padding: 7px 16px;
            background: #dc3545;
            color: white;
            border-radius: 6px;
            border: none;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.18s;
        }
        .btn-excluir:hover { background: #b91c1c; }
        .footer {
            background: rgba(255,255,255,0.5);
            color: #444;
            text-align: center;
            padding: 14px 0 12px 0;
            font-size: 1.15em;
            border-top: 1px solid #e4e4ef;
            width: 100vw;
            left: 0;
            box-shadow: 0 -1px 12px 0 rgba(102,126,234,0.08);
            font-family: 'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;
            backdrop-filter: blur(2px);
            letter-spacing: .3px;
            margin-top:32px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header-card">
		<div style="display:flex; align-items:center; gap:13px; margin-bottom:10px;">
			<img src="https://cdn-icons-png.flaticon.com/512/3661/3661395.png" alt="shield" width="46" />
			<span style="font-size:2.5em; font-weight:700; color:#667eea; margin-bottom:-2px;">IOC Analyzer - Blue Team Platform</span>
		</div>
		<div style="font-size:1.23em; color:#444; margin-bottom:22px;">
			Painel para An√°lise, Consulta R√°pida e Gerenciamento de IOCs
		</div>
		<nav>
			<a class="nav-btn" href="/"><span>üè†</span> Dashboard</a>
			<a class="nav-btn" href="/upload"><span>üì§</span> Upload de Logs</a>
			<a class="nav-btn active" href="/ioc"><span>üîé</span> IOC Panel</a>
			<a class="nav-btn" href="/cve"><span>üõ°Ô∏è</span> CVE Panel</a>
		</nav>
	</div>


        <div class="main-card">
            <h2><span>üîé</span> Busca R√°pida de IOC</h2>
            <form method="POST" action="/ioc/search" style="display: flex; gap: 18px; margin-bottom:12px;">
                <input
                    class="form-input"
                    type="text"
                    name="ioc_value"
                    required
                    placeholder="IP, Dom√≠nio, URL ou Hash"/>
                <button type="submit" class="btn-primary">
                    üîç Consultar API
                </button>
            </form>
			{% if ioc_result %}
			<div style="background: #f9fbfa; border-radius:12px; box-shadow:0 2px 18px #28a74522; border-left:7px solid #28a745; padding: 18px 24px; margin-top:16px;">
				<div style="display:flex; justify-content:space-between; align-items:center;">
					<div style="font-weight:700;font-size:1.12em;">
						<span style="color: #274d27;">üîç Resultado para:</span>
						<span style="color:#274d27; font-weight: bold;">{{ ioc_value }}</span>
					</div>
					<form method="POST" action="/ioc/add" style="display:inline;">
						<input type="hidden" name="type" value="{{ ioc_result.type }}">
						<input type="hidden" name="value" value="{{ ioc_value }}">
						<input type="hidden" name="source" value="{{ ioc_result.source }}">
						<input type="hidden" name="severity" value="{{ ioc_result.severity }}">
						<input type="hidden" name="description" value="{{ ioc_result.description }}">
						<button type="submit" class="btn-primary">Salvar IOC</button>
					</form>
				</div>
				<div style="margin:8px 0;">
					<span style="font-weight: 700;">Severidade:</span>
					{% if ioc_result.severity == "Malicioso" %}
						<span style="background:#dc3545; color:white; border-radius:5px; padding:2px 12px; margin-left:5px;">Malicioso</span>
					{% elif ioc_result.severity == "Suspeito" %}
						<span style="background:#fd7e14; color:white; border-radius:5px; padding:2px 10px; margin-left:5px;">Suspeito</span>
					{% else %}
						<span style="background:#28a745; color:white; border-radius:5px; padding:2px 10px; margin-left:5px;">N√£o Malicioso</span>
					{% endif %}
				</div>
				<div>
					<span style="font-weight:700;">Detalhamento por fonte:</span>
					<ul style="list-style:none; margin:8px 0 0 0; padding:0;">
						{% for linha in ioc_result.description.split('<br>') %}
						<li style="margin:7px 0; padding:8px 12px; background: #eaf5ea; border-radius:7px; color: #193217;">
							{{ linha|safe }}
						</li>
						{% endfor %}
					</ul>
				</div>
				<div style="margin-top:10px; font-size:0.97em; color:#666;">
					<span>Fontes consultadas: <b>{{ ioc_result.source }}</b></span>
				</div>
			</div>
			{% endif %}
	
		<!-- Filtros elegantes -->
<form method="get" action="/ioc" style="display:flex; gap:16px; align-items:center; margin-bottom:18px;">
    <select name="type" class="form-input" style="max-width:170px">
        <option value="">Tipo (todos)</option>
        {% for t in ['IP','Domain','URL','Hash','Outro'] %}
            <option value="{{ t }}" {% if request.args.get('type') == t %}selected{% endif %}>{{ t }}</option>
        {% endfor %}
    </select>
    <select name="severity" class="form-input" style="max-width:170px">
        <option value="">Severidade (todas)</option>
        {% for s in ['Malicioso','Suspeito','N√£o Malicioso','Low','Medium','High','Critical'] %}
            <option value="{{ s }}" {% if request.args.get('severity') == s %}selected{% endif %}>{{ s }}</option>
        {% endfor %}
    </select>
    <button class="btn-primary" type="submit">Filtrar</button>
</form>
        <div class="table-card">
            <h2><span>üíæ</span> Banco de Dados de IOCs</h2>
            <div style="overflow-x: auto;">
                <table>
                    <thead>
                        <tr>
                            <th>Tipo</th>
                            <th>Valor</th>
                            <th>Severidade</th>
                            <th>Descri√ß√£o</th>
                            <th>Origem</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for ioc in iocs %}
                            <tr>
                                <td>{{ ioc.type }}</td>
                                <td>{{ ioc.value }}</td>
                                <td>{{ ioc.severity }}</td>
                                <td>{{ ioc.description }}</td>
                                <td>{{ ioc.source }}</td>
                                <td>
                                    <form method="POST" action="/ioc/delete/{{ ioc.id }}" style="display:inline;">
                                        <button type="submit" class="btn-excluir" onclick="return confirm('Excluir este IOC?');">Excluir</button>
                                    </form>
                                </td>
                            </tr>
                        {% else %}
                            <tr><td colspan="7" style="text-align:center; color:#999; padding:22px 0;">Nenhum IOC cadastrado</td></tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
		<div id="pagination" style="text-align:center; margin:18px 0;"></div>
    </div>
    <footer class="footer">
        <span style="margin-right:6px;">
            <svg height="21" viewBox="0 0 20 20" width="21" fill="#764ba2" style="vertical-align:middle; margin-bottom: -5px">
                <path d="M10 2l7 4v5c0 5-7 7-7 7s-7-2-7-7V6z"/>
            </svg>
        </span>
        IOC Analyzer - Blue Team Platform - Licen√ßa GPLv3 - 2025. Autor: Pablo Nunes de Oliveira
    </footer>
</body>
</html>
